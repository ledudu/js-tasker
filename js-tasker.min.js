/**
* !js tasker by soulteary 2014.01.18
* */
(function(e,t,n){"use strict";var r="20140118";e.task={depend:{},__check__:function(e){var n=["__check__","exec","kill","add"];if(t.inArray(e,n)!==-1)throw Error("THIS METHOD DO NOT ALLOW REWRITE.");return!0},exec:function(e,r){if(!this.__check__(e))return!1;if(e in this)for(var i=0,s=this[e].length;i<s;i++)if(this.depend[e]&&this.depend[e].mask)t(this.depend[e]).each(function(r,s){t.inArray(i,s.mask)!==-1&&s.host!==n&&(task[e][s.host]!==task[e][s.mask]?(task[e][s.host]&&task[e][s.host].call(),task[e][s.mask]&&task[e][s.mask].call(),task.kill(e,s.mask),task.kill(e,s.host)):(task[e][s.host]&&task[e][s.host].call(),task.kill(e,s.host)))});else if(this.depend[e]&&!this.depend[e].mask)this.depend[e].host,this.depend[e].host!==n&&(task[e][this.depend[e].host]&&task[e][this.depend[e].host].call(),task.kill(e,this.depend[e].host));else{if(!!this.depend[e])throw Error("WAITING FOR DEPEND FUNC REG.");this[e][i]&&this[e][i].call(),this.kill(e,i--),s--}},add:function(e){var n=e.cmd,r=e.func||function(){},i=e.trigger||!1,s=e.option,o=e.title||"";if(!n||!this.__check__(n))return!1;task[n]=task[n]||[],task[n].push(r);var u=function(e){e in task&&task.exec(e,o)};if(s){var a=s.match(/(\w+):(\w+)/ig);if(a){var f=s.split(":"),l=f[0],c=f[1];switch(l){case"REG":this.depend[c]=this.depend[c]||{},this.depend[c].host&&task[n][this.depend[c].host]&&this.kill(task[n],this.depend[c].host),this.depend[c].host=t.inArray(r,task[n]),i===!0&&u(n);break;case"DEP":this.depend[c]?(task[n][this.depend[c]].call(null),delete this.depend[c],i===!0&&u(n)):(this.depend[c]={},this.depend[c].mask=this.depend[c].mask||[],this.depend[c].mask.push(t.inArray(r,task[n])))}}}else i===!0&&u(n)},kill:function(e,n){if(!this.__check__(e))return!1;task[e].splice(t.inArray(task[e][n],task[e]),1),task[e].length||delete task[e]},version:r}})(window,jQuery)